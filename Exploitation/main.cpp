#include "simulation.hpp"
#include "individu.hpp"
#include <ctime>

// extern const unsigned int TAILLE_GRILLE; // Défini dans individu.h
// extern "C" pour que la fonction ne soit pas renommée par le compilateur
// et donc utilisable dans le prog python
extern "C" int evacuate(int nb_indiv);
extern "C" void preaddPylones(int p_x,int p_y);

int pre_pylones[50];
int ind_pre=0;

int main()
{
	evacuate(100);

	return 0;
}

extern "C" void preaddPylones(int p_x,int p_y)
{
	pre_pylones[ind_pre]=p_x;
	pre_pylones[ind_pre]=p_y;
	ind_pre=ind_pre+2;
}

extern "C" int evacuate(int nb_indiv)
{
    srand(time(NULL));
	const unsigned int TAILLE_GRILLE = 40;
	Simulation<TAILLE_GRILLE > simul;

	for(unsigned int i=0; i<TAILLE_GRILLE-1; i++)
	{
		simul.addPylone(0,i);
		simul.addPylone(TAILLE_GRILLE-1,TAILLE_GRILLE-1-i);
		simul.addPylone(i,TAILLE_GRILLE-1);
		simul.addPylone(TAILLE_GRILLE-1-i,0);
	}
	
	for(int i=0; i<ind_pre-2;i=i+2)
	{
		simul.addPylone(pre_pylones[i],pre_pylones[i+1]);
	}
	
    simul.addSortie(20, 38);
	simul.addSortie(19, 38);
	simul.addNIndiv(nb_indiv);

	return simul.run();
}
